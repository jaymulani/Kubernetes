steps:

  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'northamerica-northeast1-docker.pkg.dev/cloud-390101/cloud/container1:latest', '.']

  - name: 'gcr.io/cloud-builders/docker'
    args: ['push', 'northamerica-northeast1-docker.pkg.dev/cloud-390101/cloud/container1:latest']

  - name: 'gcr.io/cloud-builders/kubectl'
    args: ['apply', '-f', 'kubernetes.yaml']
    env:
      - 'CLOUDSDK_COMPUTE_REGION=northamerica-northeast1-a'
      - 'CLOUDSDK_CONTAINER_CLUSTER=dev-cloud'
      - 'CLOUDSDK_CORE_PROJECT=cloud-390101'

options:
  logging: CLOUD_LOGGING_ONLY
